# FlowDose Environment Variables Documentation

This document provides details on all environment variables used by the FlowDose applications.

## Backend Environment Variables (MedusaJS)

| Variable | Description | Required | Example |
|----------|-------------|----------|---------|
| `NODE_ENV` | Environment mode | Yes | `production`, `staging`, `development` |
| `PORT` | Server port | No | `9000` |
| `ADMIN_CORS` | CORS for admin UI | Yes | `https://admin-staging.flowdose.xyz` |
| `STORE_CORS` | CORS for storefront | Yes | `https://staging.flowdose.xyz` |
| `AUTH_CORS` | CORS for auth endpoints | Yes | `https://admin-staging.flowdose.xyz,https://staging.flowdose.xyz` |
| `DATABASE_URL` | PostgreSQL connection URL | Yes | `postgres://user:pass@host:5432/db` |
| `REDIS_URL` | Redis connection URL | Yes | `redis://user:pass@host:6379` |
| `JWT_SECRET` | Secret for JWT tokens | Yes | Random string, 32+ chars |
| `COOKIE_SECRET` | Secret for cookies | Yes | Random string, 32+ chars |
| `ADMIN_EMAIL` | Default admin email | Yes | `admin@flowdose.xyz` |
| `ADMIN_PASSWORD` | Default admin password | Yes | Secure password |
| `RESEND_API_KEY` | Resend.com API key | Yes | API key from Resend dashboard |
| `RESEND_FROM` | From email for outgoing emails | Yes | `no-reply@flowdose.xyz` |
| `S3_ENDPOINT` | S3/Spaces endpoint | Yes | `sfo3.digitaloceanspaces.com` |
| `S3_BUCKET` | S3/Spaces bucket name | Yes | `staging-flowdose-bucket` |
| `S3_ACCESS_KEY` | S3/Spaces access key | Yes | Your Spaces access key |
| `S3_SECRET_KEY` | S3/Spaces secret key | Yes | Your Spaces secret key |
| `S3_FORCE_PATH_STYLE` | Use path style for S3 URLs | No | `true` |
| `S3_REGION` | S3/Spaces region | Yes | `sfo3` |
| `API_URL` | Public API URL | Yes | `https://api-staging.flowdose.xyz` |
| `MEDUSA_BACKEND_URL` | Backend URL for internal use | Yes | `https://api-staging.flowdose.xyz` |
| `ENABLE_ADMIN` | Enable admin panel | No | `true` |
| `ENABLE_PUBLISHABLE_API_KEY` | Enable publishable API keys | No | `true` |

## Storefront Environment Variables (Next.js)

| Variable | Description | Required | Example |
|----------|-------------|----------|---------|
| `NEXT_PUBLIC_API_URL` | Backend API URL | Yes | `https://api-staging.flowdose.xyz` |
| `NEXT_PUBLIC_MEDUSA_BACKEND_URL` | Same as API URL | Yes | `https://api-staging.flowdose.xyz` |
| `NEXT_PUBLIC_MEDUSA_PUBLISHABLE_KEY` | Medusa publishable API key | Yes | Generated by Medusa backend |
| `NEXT_PUBLIC_SITE_NAME` | Site name | No | `FlowDose` |
| `NEXT_PUBLIC_SITE_URL` | Storefront URL | Yes | `https://staging.flowdose.xyz` |
| `NEXT_PUBLIC_DEFAULT_REGION` | Default region for store | No | `US` |
| `REVALIDATE_SECRET` | Secret for revalidation | Yes | Random string |
| `NEXT_PUBLIC_SEARCH_ENABLED` | Enable search features | No | `true` |
| `NEXT_PUBLIC_GA_TRACKING_ID` | Google Analytics ID | No | `G-XXXXXXXX` |
| `NODE_TLS_REJECT_UNAUTHORIZED` | Ignore SSL issues in dev | No | `0` in development only |

## Environment Variables in Terraform

These variables are managed through our Terraform configuration:

1. **Template files** (`templates/backend.env.tpl` and `templates/storefront.env.tpl`) define the structure of the environment files
2. **Terraform variables** in `terraform.tfvars` and `secrets.tfvars` provide the actual values
3. **Environment module** generates the environment files and uploads them to the servers

## Security Considerations

- Never store sensitive values (passwords, API keys, secrets) in version control
- Use `secrets.tfvars` for all sensitive values, which is excluded from git
- Rotate secrets periodically, especially for production environments
- Use different secrets for different environments (staging, production)

## Adding New Environment Variables

To add a new environment variable:

1. Add it to the appropriate template file (`backend.env.tpl` or `storefront.env.tpl`)
2. Update the `env_config` module's `main.tf` to pass the variable to the template
3. Add the variable to `variables.tf` in the `env_config` module
4. Add the variable to your `terraform.tfvars` or `secrets.tfvars` file (if sensitive)
5. Run `terraform apply` to update the environment files 